<div class="submission-container">
    <ul class="breadcrumb">
        <li><a (click)="navigateToDashboard()">Home</a></li>
        <li class="last">{{ flag | titlecase }}</li>
        <li class="last">submissions</li>
    </ul>
    <div class="header-container mat-elevation-z1">
        <span class="header-text">
            Submissions
        </span>

        <div class="submission-actions">
            <!-- <button mat-icon-button class="add-user" (click)="uploadVendor()">
          <mat-icon class="item-icon">upload</mat-icon>
        </button> -->
            <button [disabled]="!privilegeServ.hasPrivilege('ADD_SUBMISSIONS_SALES')" matTooltip="Add"   *ngIf="this.flag == 'Sales'"
            matTooltipPosition="left" mat-icon-button class="add-submission" (click)="addSubmission()">
                <mat-icon [ngClass]="{'item-icon': privilegeServ.hasPrivilege('ADD_SUBMISSIONS_SALES')}">add_circle</mat-icon>
            </button>


            <button [disabled]="!privilegeServ.hasPrivilege('ADD_SUBMISSIONS_RECRUITING')" matTooltip="Add" *ngIf="this.flag == 'Recruiting'"
            matTooltipPosition="left" mat-icon-button class="add-submission" (click)="addSubmission()">
                <mat-icon [ngClass]="{'item-icon': privilegeServ.hasPrivilege('ADD_SUBMISSIONS_RECRUITING')}">add_circle</mat-icon>
            </button>

            <button [disabled]="!privilegeServ.hasPrivilege('ADD_SUBMISSIONS_DOM')" matTooltip="Add" *ngIf="this.flag == 'Domrecruiting'"
            matTooltipPosition="left" mat-icon-button class="add-submission" (click)="addSubmission()">
                <mat-icon [ngClass]="{'item-icon': privilegeServ.hasPrivilege('ADD_SUBMISSIONS_DOM')}">add_circle</mat-icon>
            </button>
           

            

            <div class="search-submission">
                <!-- <mat-icon class="item-icon">person_search</mat-icon> -->
                <form [formGroup]="filterForm">
                <input matInput  type="search" formControlName="position" style="" class="search" placeholder="Search Position" >
                <input matInput  type="search" formControlName="location" style="margin-left:0.4rem; margin-right: 0.4rem;" class="search" placeholder="Search Location" >
                <input matInput type="text" class="search" placeholder="search submissions" (keyup)="applyFilter($event)">

                </form>
            </div>
        </div>
    </div>
    <div id="table-container" class="table-wrapper">
        <section class="mat-elevation-z8" [ngClass]="{'dom-submission-table-style': flag === 'Domrecruiting', 'submission-table-style': flag !== 'Domrecruiting'}" class="vendor-table-style">
            <table mat-table [dataSource]="dataSource" matSort (matSortChange)="onSort($event)" oncopy="return false "       class="sticky-table"
            >

                <!--- Note that these columns can be defined in any order.
                The actual rendered columns are set as a property on the row definition" -->

                <!-- SNo Column mat-sort-header-->
                <ng-container matColumnDef="SerialNum">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by Serial Number" mat-sort-header sticky> 
                        S.No </th>
                    <td mat-cell *matCellDef="let element"> {{element?.serialNum}} </td>
                </ng-container>
                <!-- Date-->
                <ng-container matColumnDef="Dos">
                    <th mat-header-cell *matHeaderCellDef  sortActionDescription="Sort by Date" mat-sort-header sticky> DOS
                    </th>
                    <td mat-cell *matCellDef="let element" nowrap> {{element?.createddate | date:'MM-dd-yyyy HH:mm'}} </td>
                </ng-container>
                <!-- ID-->
                <!-- <ng-container matColumnDef="Id">
                    <th mat-header-cell *matHeaderCellDef  sortActionDescription="Sort by ID" mat-sort-header> Submission
                        ID </th>
                    <td mat-cell *matCellDef="let element">
                        {{element?.subno}}
                     
                    </td>
                </ng-container> -->
                <ng-container matColumnDef="Id">
                    <th mat-header-cell *matHeaderCellDef  sortActionDescription="Sort by Id" mat-sort-header sticky>
                        Submission ID
                    </th>
                    <!-- <td mat-cell *matCellDef="let element">
                        <ng-container *ngIf="this.flag == 'Recruiting'; then trueCondition else elseTemplate"></ng-container>
                        <ng-container *ngIf="this.flag === 'Domrecruiting'; then anotherCondition"></ng-container>
                        <ng-template #trueCondition>
                            <span class="consultant-id" (click)="goToReqInfo(element)">{{ element?.subno }}
                            </span>
                        </ng-template>
                        <ng-template #anotherCondition>
                            <span class="consultant-id" (click)="goToReqInfo(element)">{{ element?.subno }}
                            </span>
                        </ng-template>
                        <ng-template #elseTemplate>
                            {{ element?.position | titlecase}}
                        </ng-template>
                    </td> -->
                    <td mat-cell *matCellDef="let element">
                        <span class="consultant-id"
                        (click)="goToReqInfo(element)">{{ element?.subno }}
                    </span>
                      
                    </td>
                </ng-container>
                <!-- Name-->
                <ng-container matColumnDef="Consultant">
                    <th mat-header-cell *matHeaderCellDef sortActionDescription="Sort by Consultant" mat-sort-header sticky>
                        Consultant </th>
                    <td mat-cell *matCellDef="let element">
                        <span class="consultant-id"
                        (click)="goToConsultantInfo(element, flag)">{{element?.consultantname|titlecase}}
                      </span>
                        <!-- <span class="consultant-name" (click)="goToSubmissionInfo(element, 'name')"> 
                            {{element?.consultantname}}
                        </span> -->
                    </td>
                </ng-container>
                <!-- Track(S/I)-->
                <!-- <ng-container matColumnDef="TrackSI">
                    <th mat-header-cell *matHeaderCellDef sortActionDescription="Sort by Track(S/I)"> Track(S/I) </th>
                    <td mat-cell *matCellDef="let element">

                        <span class="submission-icon"
                            (click)="goToSubmissionDrillDownReport(element,'submission')"><mat-icon>
                                assignment
                            </mat-icon></span>
                        <span (click)="goToSubmissionDrillDownReport(element,'interview')"><mat-icon
                                class="interview-icon">chat_bubble_outline</mat-icon></span>

                </ng-container> -->
                <!-- Requirement-->
                <!-- <ng-container matColumnDef="Requirement">
                    <th mat-header-cell *matHeaderCellDef  sortActionDescription="Sort by Requirement" mat-sort-header>
                        Requirement
                    </th>
                    <td mat-cell *matCellDef="let element">
                        <ng-container *ngIf="this.flag == 'Recruiting'; then trueCondition else elseTemplate"></ng-container>
                        <ng-container *ngIf="this.flag === 'Domrecruiting'; then anotherCondition"></ng-container>
                        <ng-template #trueCondition>
                            <span class="consultant-id" (click)="goToReqInfo(element)">{{ element?.reqnumber }}
                            </span>
                        </ng-template>
                        <ng-template #anotherCondition>
                            <span class="consultant-id" (click)="goToReqInfo(element)">{{ element?.reqnumber }}
                            </span>
                        </ng-template>
                        <ng-template #elseTemplate>
                            {{ element?.position | titlecase}}
                        </ng-template>
                    </td>
                </ng-container> -->
                <ng-container matColumnDef="Position">
                    <th mat-header-cell *matHeaderCellDef 
                        sortActionDescription="Sort by Position" mat-sort-header sticky> Position</th>
                    <td mat-cell *matCellDef="let element"> {{element?.position|titlecase}}
                    </td>
                </ng-container>
                  <!-- Vendor Location -->
                  <ng-container matColumnDef="Vendor">
                    <th mat-header-cell *matHeaderCellDef 
                        sortActionDescription="Sort by Current Vendor" mat-sort-header sticky> Third Party Vendor </th>
                    <td mat-cell *matCellDef="let element"> {{element?.vendor|titlecase}}
                    </td>
                </ng-container>

                <!-- Implementation Partner-->
                <ng-container matColumnDef="ImplementationPartner">
                    <th mat-header-cell *matHeaderCellDef  sortActionDescription="Sort by ImplementationPartner" mat-sort-header sticky>
                        IP / Vendor </th>
                    <td mat-cell *matCellDef="let element"> {{element?.implpartner | titlecase}}
                    </td>
                </ng-container>
                <!-- End Client-->
                <ng-container matColumnDef="EndClient">
                    <th mat-header-cell *matHeaderCellDef  sortActionDescription="Sort by EndClient" mat-sort-header sticky> End
                        Client </th>
                    <td mat-cell *matCellDef="let element"> {{element?.endclient | titlecase}}
                    </td>
                </ng-container>
              

                <!-- Sub Rate Column 
                <ng-container matColumnDef="SubRate">
                    <th mat-header-cell *matHeaderCellDef  sortActionDescription="Sort by SubRate" mat-sort-header>
                        Sub Rate</th>
                    <td mat-cell *matCellDef="let element">  {{ NumericValue(element.submissionrate)}}
                    </td>
                </ng-container>-->
                <ng-container matColumnDef="SubRate">
                    <th mat-header-cell *matHeaderCellDef  sortActionDescription="Sort by SubRate" mat-sort-header sticky>
                      Sub Rate
                    </th>
                    <td mat-cell *matCellDef="let element">  
                      <!-- Check if flag is set to "Recruiting" before applying the NumericValue method -->
                      {{ element.submissionrate }}
                      
                    </td>
                  </ng-container>
                  
                <!-- Project Location Column -->
                <ng-container matColumnDef="ProjectLocation">
                    <th mat-header-cell *matHeaderCellDef  sortActionDescription="Sort by ProjectLocation" mat-sort-header sticky>
                        Project Location</th>
                    <td mat-cell *matCellDef="let element"> {{element.projectlocation | titlecase}} </td>
                </ng-container>

                <!-- Submitted By Column -->
                <ng-container matColumnDef="SubmittedBy">
                    <th mat-header-cell *matHeaderCellDef  sortActionDescription="Sort by SubmittedBy" mat-sort-header sticky>
                        Submitted By
                    </th>
                    <td mat-cell *matCellDef="let element"> 
                        <span class="navlink" (click)="goToUserInfo(element.userid)">{{element.pseudoname | titlecase}}</span>
                     </td>
                    <td mat-cell *matCellDef="let element">
                        <ng-container *ngIf="this.flag === 'Sales'; then trueCondition1 else elseTemplate1"></ng-container>
                        <ng-template #trueCondition1>
                            <span class="navlink" (click)="goToUserInfo(element.userid)"> {{ element?.pseudoname | titlecase }} </span>
                        </ng-template>
                        <ng-template #elseTemplate1>
                            <span class="navlink" (click)="goToUserInfo(element.userid)">{{ element?.fullname | titlecase }}</span>
                        </ng-template>
                    </td>
                </ng-container>

                 <!-- Status Column -->
                 <ng-container matColumnDef="Status">
                    <th mat-header-cell *matHeaderCellDef  sortActionDescription="Sort by Status" mat-sort-header sticky>
                        Status
                    </th>
                    <td mat-cell *matCellDef="let element"> {{element.substatus | titlecase}} </td>
                </ng-container>

                <!-- Sub Status Column -->
                <ng-container matColumnDef="SubStatus">
                    <th mat-header-cell *matHeaderCellDef  sortActionDescription="Sort by SubStatus" mat-sort-header sticky>
                        Sub Status
                    </th>
                    <td mat-cell *matCellDef="let element"> {{element.status | titlecase}} </td>
                </ng-container>

                <!-- Action Column -->
                <ng-container matColumnDef="Action">
                    <th mat-header-cell *matHeaderCellDef sticky> Action </th>
                    <td mat-cell *matCellDef="let submission">
                        <span class="action-buttons">

                            <button [disabled]="!privilegeServ.hasPrivilege('EDIT_SUBMISSIONS_SALES')" mat-icon-button *ngIf="this.flag == 'Sales'"
                            (click)="editSubmission(submission)" class="action-button-ed">
                                <mat-icon [ngClass]="{'edit-icon': privilegeServ.hasPrivilege('EDIT_SUBMISSIONS_SALES')}">edit</mat-icon>
                            </button>

                            <button [disabled]="!privilegeServ.hasPrivilege('EDIT_SUBMISSIONS_RECRUITING')" mat-icon-button *ngIf="this.flag == 'Recruiting'"
                            (click)="editSubmission(submission)" class="action-button-ed">
                                <mat-icon [ngClass]="{'edit-icon': privilegeServ.hasPrivilege('EDIT_SUBMISSIONS_RECRUITING')}">edit</mat-icon>
                            </button>
                            <button [disabled]="!privilegeServ.hasPrivilege('EDIT_SUBMISSIONS_DOM')" mat-icon-button *ngIf="this.flag == 'Domrecruiting'"
                            (click)="editSubmission(submission)" class="action-button-ed">
                                <mat-icon [ngClass]="{'edit-icon': privilegeServ.hasPrivilege('EDIT_SUBMISSIONS_DOM')}">edit</mat-icon>
                            </button>


                            <button  [disabled]="!privilegeServ.hasPrivilege('DELETE_SUBMISSIONS_SALES')" mat-icon-button *ngIf="this.flag == 'Sales'"
                             (click)="deleteSubmission(submission)" class="action-button-ed">
                                <mat-icon [ngClass]="{'delete-icon': privilegeServ.hasPrivilege('DELETE_SUBMISSIONS_SALES')}">delete</mat-icon>
                            </button>

                            <button  [disabled]="!privilegeServ.hasPrivilege('DELETE_SUBMISSIONS_RECRUITING')" mat-icon-button *ngIf="this.flag == 'Recruiting'"
                            (click)="deleteSubmission(submission)" class="action-button-ed">
                                <mat-icon [ngClass]="{'delete-icon': privilegeServ.hasPrivilege('DELETE_SUBMISSIONS_RECRUITING')}">delete</mat-icon> 
                            </button>

                            <button  [disabled]="!privilegeServ.hasPrivilege('DELETE_SUBMISSIONS_DOM')"  *ngIf="this.flag == 'Domrecruiting'"
                            mat-icon-button (click)="deleteSubmission(submission)" class="action-button-ed">
                                <mat-icon [ngClass]="{'delete-icon': privilegeServ.hasPrivilege('DELETE_SUBMISSIONS_DOM')}">delete</mat-icon>
                            </button>
                           
                        </span>
                    </td>
                </ng-container>
                <!-- table columns ends  -->
                <!-- table ROW -->
                <tr mat-header-row *matHeaderRowDef="dataTableColumns; sticky: true"></tr>
                <tr mat-row *matRowDef="let row; columns: dataTableColumns;" [ngStyle]="getRowStyles(row)"></tr>
            </table>
            <p class="no-data-found" *ngIf="!dataSource.filteredData.length">{{'No matching data found'}}</p>
        </section>
        <hr>
    </div>

    <div class="paginator">

         <!-- paginator -->
      <mat-paginator   (page)="handlePageEvent($event)"
      [length]="totalItems" [pageSize]="pageSize"
      [disabled]="false" [showFirstLastButtons]="showFirstLastButtons"
      [pageSizeOptions]="showPageSizeOptions ? pageSizeOptions : []"
      [hidePageSize]="hidePageSize"
      [pageIndex]="currentPageIndex" aria-label="Select page">
    </mat-paginator>
      </div>

</div>
